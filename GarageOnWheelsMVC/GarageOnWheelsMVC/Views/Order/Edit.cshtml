@* @model GarageOnWheelsMVC.Models.Order

@{
    ViewData["Title"] = "Edit Order";
}

<h2 class="text-center mb-4">Edit Order</h2>


<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <form asp-action="Edit" asp-controller="Order" method="post" class="needs-validation shadow p-4 rounded bg-light" novalidate>

           
                <div class="form-group mb-3">
                    <label asp-for="TotalAmount" class="form-label">Total Amount<span class="text-danger fw-bold">*</span></label>
                    <input asp-for="TotalAmount" id="totalAmount" class="form-control" type="number" step="0.01" placeholder="Enter the total amount" />
                    <span asp-validation-for="TotalAmount" class="text-danger"></span>
                </div>

                <input asp-for="GarageId" hidden />
                <input asp-for="UserId" hidden />
                <input asp-for="ServiceDetails" hidden />
                <input type="hidden" asp-for="Id" />


                <div class="form-group mb-4">
                    <label asp-for="Status" class="form-label">Order Status<span class="text-danger fw-bold">*</span></label>
                    <select asp-for="Status" class="form-select form-select-lg" required>
                        <option value="">Select Status</option>
                        <option value="Completed">Completed</option>
                       
                    </select>
                    <span asp-validation-for="Status" class="text-danger"></span>
                </div>

                <div class="d-flex justify-content-center mt-3">
                    <a asp-action="GetOrdersByGarage" class="btn btn-warning flex-fill me-2">Cancel</a>
                    <button type="submit" class="btn btn-primary flex-fill">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <script>
        (function () {
            'use strict';

            var forms = document.querySelectorAll('.needs-validation');
            Array.prototype.slice.call(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    var totalAmount = $('#totalAmount').val();
                    if (totalAmount === "" || parseFloat(totalAmount) <= 0) {
                        event.preventDefault();
                        event.stopPropagation();
                        alert("Please provide a valid Total Amount greater than 0.");
                    }
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    } else {
                        event.preventDefault();
                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("Edit", "Order")',
                            data: $(form).serialize(),
                            success: function () {
                                window.location.href = '@Url.Action("GetOrdersByGarage", "Order")';
                            },
                            error: function (xhr) {
                                var errorMessage = xhr.responseText || "An error occurred. Please try again.";
                                alert(errorMessage);
                            }
                        });
                    }

                    form.classList.add('was-validated');
                }, false);
            });
        })();
    </script>
}
 *@